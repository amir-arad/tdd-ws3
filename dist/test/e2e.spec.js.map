{"version":3,"sources":["e2e.spec.js"],"names":[],"mappings":"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","file":"e2e.spec.js","sourcesContent":["require('source-map-support').install();\nvar Promise = require('promise');\nimport redis from 'then-redis';\nimport theRealThing from '../src/main';\n\nvar childProcess = require('child_process');\nconst SNIPER_ID = 'sniper';\nconst REDIS_HOSTNAME = 'localhost';\nconst STATUS = 'STATUS';\n\nvar statuses = {\n\tSTATUS_JOINING: 'STATUS_JOINING',\n\tSTATUS_LOST: 'STATUS_LOST'\n}\n\nclass AuctionSniperDriver{\n\tshowsSniperStatus(statusText) {\n\t\treturn new Promise((result, err) => {err('not implemented');});\n\t\t// webDriver.hasDivCalled(STATUS).hasText(statusText);\n\t}\n}\n\nclass ApplicationRunner {\n\tconstructor() {\n\t\tthis.driver = new AuctionSniperDriver(1000);\n\t}\n\tstartBiddingIn(auction) {\n\t\t// todo: start main program with some arguments\n\t\ttheRealThing.main();\n\t\treturn this.driver.showsSniperStatus(statuses.STATUS_JOINING); \n\t}\n\tshowsSniperHasLostAuction () {\n\t\treturn this.driver.showsSniperStatus(statuses.STATUS_LOST); \n\t}\n\tstop(){\n\t\t// stop application\n\t\tconsole.log('Hello');\n\t}\n\tshowSniperHasLostAuction(){\n\n\t}\n}\n\n\nclass FakeAuctionServer {\n\tconstructor(itemId) {\n\t\tthis.itemId = itemId;\n\t}\n\thasRecievedJoinRequestFromSniper(){\n\t\tthrow new Error(\"join request was not received\");\n\t}\n\tannounceClosed(){\n\t\treturn redis.createClient().publish(this.itemId, \"done\");\n\t}\n\tstartSellingItem() {\n\t\tthis.redisListener = redis.createClient();\n\t\treturn this.redisListener.subscribe(this.itemId);\n\t}\n}\n\ndescribe('the auction sniper', () =>{\n\tvar auction;\n\tvar application;\n\tbefore('auction sniper e2e',() => {\n\t\tauction = new FakeAuctionServer('item-5347');\t\t\n\t\tapplication = new ApplicationRunner();\n\t});\n\n\tit('joins an auction untill it closes', () => {\n\t\treturn auction.startSellingItem()\n\t\t\t.then(() => application.startBiddingIn('item-5347'))\n\t\t\t.then(() => auction.hasRecievedJoinRequestFromSniper())\n\t\t\t.then(() => auction.announceClosed())\n\t\t\t.then(() => application.showSniperHasLostAuction());\n\t});\t\n\t\n\tafter('something', () => {\n\t\tapplication.stop();\n\t});\n});"],"sourceRoot":"/source/"}